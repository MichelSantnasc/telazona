<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="appTitle">
      TELAZONA - Assista Múltiplas Lives Simultaneamente
    </title>
    <meta
      name="description"
      data-i18n="appDescription"
      content="Assista lives do YouTube, Twitch e Kick em uma única tela. Multistreaming simples e responsivo para mobile e desktop."
    />
    <meta
      name="keywords"
      content="lives, streaming, multistream, YouTube, Twitch, Kick, telazona, multilanguage"
    />
    <meta property="og:title" content="TELAZONA - Multilives" />
    <meta
      property="og:description"
      data-i18n="appDescription"
      content="Assista múltiplas lives simultaneamente em uma única tela. Suporta YouTube, Twitch e Kick."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://telazona.live/" />
    <link rel="canonical" href="https://telazona.live/" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&family=Inter:wght@400&display=swap"
      rel="stylesheet"
    />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "TELAZONA",
        "description": "Plataforma para assistir múltiplas lives simultaneamente",
        "url": "https://telazona.live/",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": "Web"
      }
    </script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
      :root {
        --bg-primary: #0a0a0a;
        --bg-secondary: #1a1a1a;
        --bg-tertiary: #242424;
        --text-primary: #ffffff;
        --text-secondary: #a0a0a0;
        --accent: #00d084;
        --accent-hover: #00b377;
        --border: #333333;
        --shadow: 0 8px 32px rgba(0, 208, 132, 0.3);
        --shadow-light: 0 4px 16px rgba(0, 0, 0, 0.4);
        --neon-glow: 0 0 20px rgba(0, 208, 132, 0.6);
        --gradient: linear-gradient(
          135deg,
          var(--accent) 0%,
          var(--accent-hover) 100%
        );
        --border-radius: 12px;
        --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        --header-height: 60px;
        --footer-height: 30px;
        --gap: 16px;
      }
      body {
        font-family: "Inter", sans-serif;
        font-weight: 400;
        background: var(--bg-primary);
        color: var(--text-primary);
        overflow-x: hidden;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        height: 100vh;
      }
      .silkscreen-regular {
        font-family: "Silkscreen", sans-serif;
        font-weight: 400;
        font-style: normal;
      }
      .header-custom {
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border);
        box-shadow: var(--shadow-light);
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 100;
        padding: 0 24px;
        height: var(--header-height);
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: var(--transition);
        box-sizing: border-box;
      }
      .header-custom.hidden {
        transform: translateY(-100%);
      }
      .logo {
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 2px;
        color: var(--text-primary);
        text-transform: uppercase;
        flex-shrink: 0;
      }
      .header-right {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: nowrap;
        min-width: 0;
        flex: 1;
        justify-content: flex-end;
      }
      .header-right > * {
        flex-shrink: 0;
      }
      .btn-header {
        background: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border);
        padding: 10px 16px;
        border-radius: var(--border-radius);
        font-size: 14px;
        font-weight: 400;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 4px;
        text-decoration: none;
        cursor: pointer;
        white-space: nowrap;
        flex-shrink: 0;
      }
      .btn-header:hover {
        background: var(--gradient);
        color: var(--text-primary);
        border-color: var(--accent);
        box-shadow: var(--neon-glow);
        transform: translateY(-2px);
      }
      .toggle-btn {
        background: rgba(26, 26, 26, 0.95);
        backdrop-filter: blur(20px);
        color: var(--text-primary);
        border: 1px solid var(--border);
        padding: 12px 20px;
        border-radius: var(--border-radius);
        font-size: 14px;
        font-weight: 400;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        z-index: 102;
        position: absolute;
        left: 24px;
        bottom: -40px;
      }
      .toggle-btn:hover {
        background: var(--gradient);
        color: var(--text-primary);
        border-color: var(--accent);
        box-shadow: var(--neon-glow);
      }
      .toggle-btn.fixed {
        position: fixed;
        top: 10px;
        left: 24px;
        bottom: auto;
        padding: 8px;
        min-width: 200px;
      }
      .toggle-btn.fixed .controls-flex {
        display: flex;
        gap: 8px;
        align-items: center;
        justify-content: center;
      }
      .toggle-btn.fixed button {
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 400;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 4px;
        transition: var(--transition);
        border: none;
        white-space: nowrap;
      }
      .toggle-btn.fixed .show-ui-btn {
        background: var(--gradient);
        color: var(--text-primary);
      }
      .toggle-btn.fixed .show-ui-btn:hover {
        box-shadow: var(--neon-glow);
        transform: translateY(-1px);
      }
      .toggle-btn.fixed .chat-toggle-btn {
        background: transparent;
        color: var(--text-primary);
        border: 1px solid var(--border);
      }
      .toggle-btn.fixed .chat-toggle-btn:hover {
        background: var(--gradient);
        border-color: var(--accent);
        color: var(--text-primary);
        box-shadow: var(--neon-glow);
      }
      .hamburger {
        display: none;
        flex-direction: column;
        cursor: pointer;
        gap: 4px;
        flex-shrink: 0;
      }
      .hamburger span {
        width: 24px;
        height: 2px;
        background: var(--text-primary);
        transition: var(--transition);
        border-radius: 1px;
      }
      .hamburger.active span:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
      }
      .hamburger.active span:nth-child(2) {
        opacity: 0;
      }
      .hamburger.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -6px);
      }
      .mobile-menu {
        position: fixed;
        top: 0;
        right: -100%;
        width: 80%;
        max-width: 300px;
        height: 100vh;
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(20px);
        transition: right 0.3s ease;
        z-index: 1000;
        padding: 80px 24px 24px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .mobile-menu.active {
        right: 0;
      }
      .close-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        font-size: 24px;
        cursor: pointer;
        transition: var(--transition);
      }
      .close-btn:hover {
        color: var(--accent);
      }
      .mobile-btn {
        background: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border);
        padding: 14px;
        border-radius: var(--border-radius);
        font-size: 18px;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        text-align: left;
        text-decoration: none;
      }
      .mobile-btn:hover {
        background: var(--gradient);
        color: var(--text-primary);
        border-color: var(--accent);
        box-shadow: var(--neon-glow);
      }
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
        z-index: 999;
      }
      .overlay.active {
        opacity: 1;
        visibility: visible;
      }
      .add-modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(26, 26, 26, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid var(--border);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        z-index: 1001;
        display: none;
        flex-direction: column;
        width: 90%;
        max-width: 400px;
        padding: 32px;
        animation: modalSlideIn 0.3s ease;
      }
      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1);
        }
      }
      .add-modal.active {
        display: flex;
      }
      .add-modal h2 {
        text-align: center;
        margin-bottom: 16px;
        color: var(--text-primary);
        font-weight: 400;
      }
      .platforms {
        display: flex;
        justify-content: space-around;
        align-items: center;
        margin-bottom: 16px;
        flex-wrap: wrap;
        opacity: 0.8;
      }
      .platform-item {
        text-align: center;
        margin: 5px;
      }
      .platform-item i {
        font-size: 40px;
        margin-bottom: 4px;
        color: var(--accent);
      }
      .add-modal input {
        background: rgba(36, 36, 36, 0.8);
        backdrop-filter: blur(10px);
        color: var(--text-primary);
        border: 1px solid var(--border);
        border-radius: var(--border-radius);
        padding: 12px;
        margin-bottom: 24px;
        transition: var(--transition);
        width: 100%;
        box-sizing: border-box;
      }
      .add-modal input:focus {
        border-color: var(--accent);
        box-shadow: var(--neon-glow);
        outline: none;
      }
      .btn-group {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }
      .btn-modal {
        background: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border);
        padding: 14px 28px;
        border-radius: var(--border-radius);
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        font-weight: 400;
      }
      .btn-primary-modal {
        background: var(--gradient);
        color: var(--text-primary);
        border-color: var(--accent);
      }
      .btn-primary-modal:hover {
        box-shadow: var(--neon-glow);
        transform: translateY(-2px);
      }
      .btn-secondary-modal:hover {
        background: var(--border);
        color: var(--text-primary);
      }
      .loading-spinner {
        border: 4px solid var(--border);
        border-top: 4px solid var(--accent);
        border-radius: 50%;
        width: 20px;
        height: 20px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      .loading {
        display: none;
        text-align: center;
        padding: 20px;
      }
      .loading.active {
        display: block;
      }
      .btn-group:not(.active) {
        display: none;
      }
      main {
        margin-top: var(--header-height);
        height: calc(100vh - var(--header-height) - var(--footer-height));
        display: flex;
        flex-direction: column;
        transition: var(--transition);
        overflow: hidden;
        padding: 20px;
        box-sizing: border-box;
      }
      #main-content {
        display: none;
        flex: 1;
        overflow: hidden;
        flex-direction: row;
      }
      #hero-section {
        text-align: center;
        max-width: 800px;
        margin: 0 auto;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 24px;
      }
      .hero-title {
        font-size: 4rem;
        font-weight: 700;
        margin-bottom: 16px;
        color: var(--text-primary);
        letter-spacing: 1px;
        text-transform: uppercase;
        line-height: 1.1;
      }
      .hero-subtitle {
        font-size: 1.5rem;
        color: var(--text-secondary);
        margin-bottom: 40px;
        line-height: 1.5;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }
      .hero-btn {
        background: var(--gradient);
        color: var(--text-primary);
        border: none;
        padding: 20px 40px;
        border-radius: var(--border-radius);
        font-size: 18px;
        font-weight: 400;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        cursor: pointer;
        box-shadow: var(--shadow);
      }
      .hero-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 208, 132, 0.4);
      }
      .grid-container {
        flex: 1;
        display: grid;
        gap: 0;
        width: 100%;
        padding: 0;
        transition: var(--transition);
        margin: 0 auto;
        height: 100%;
        overflow: hidden;
        align-content: stretch;
        will-change: transform;
      }
      .chat-container {
        width: 350px;
        background: var(--bg-secondary);
        border-left: 1px solid var(--border);
        display: none;
        overflow: hidden;
        flex-direction: column;
        margin-top: var(--gap);
        flex: 0 0 350px;
      }
      #chat-selector {
        padding: 10px;
        border-bottom: 1px solid var(--border);
        background: var(--bg-tertiary);
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
        align-items: center;
      }
      .chat-btn {
        background: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border);
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 12px;
        transition: var(--transition);
        cursor: pointer;
        white-space: nowrap;
      }
      .chat-btn:hover {
        background: var(--gradient);
        color: var(--text-primary);
        border-color: var(--accent);
        box-shadow: var(--neon-glow);
      }
      .chat-btn.active {
        background: var(--gradient);
        color: var(--text-primary);
        border-color: var(--accent);
      }
      .chat-placeholder {
        height: 100%;
        padding: 10px;
        overflow: auto;
        color: var(--text-secondary);
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .live-wrapper {
        position: relative;
        aspect-ratio: 16/9;
        border-radius: var(--border-radius);
        box-shadow: none;
        overflow: hidden;
        background: transparent;
        border: none;
        transition: var(--transition);
        min-width: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
        cursor: pointer;
        will-change: transform;
        width: 100%;
        height: 100%;
      }
      .live-wrapper:hover {
        box-shadow: var(--neon-glow);
        transform: scale(1.01);
      }
      .live-wrapper.selected {
        border-color: var(--accent);
        box-shadow: var(--neon-glow);
      }
      .live-wrapper.full-height,
      .live-wrapper.stretch-height {
        aspect-ratio: none;
        height: 100%;
      }
      .live-wrapper.two-col {
        aspect-ratio: 16/7;
      }
      .live-frame {
        width: 100%;
        height: 100%;
        border: none;
        border-radius: var(--border-radius);
      }
      .menu-toggle {
        position: absolute;
        top: 12px;
        left: 12px;
        background: rgba(0, 0, 0, 0.7);
        color: var(--text-primary);
        border: none;
        padding: 8px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 16px;
        z-index: 10;
        transition: var(--transition);
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .menu-toggle:hover {
        background: var(--accent);
        color: var(--text-primary);
        box-shadow: var(--neon-glow);
        transform: scale(1.1);
      }
      .context-menu {
        position: absolute;
        top: 60px;
        left: 12px;
        background: rgba(26, 26, 26, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        z-index: 11;
        display: none;
        flex-direction: column;
        min-width: 160px;
      }
      .context-menu.active {
        display: flex;
      }
      .context-item {
        background: transparent;
        color: var(--text-secondary);
        border: none;
        padding: 12px 16px;
        text-align: left;
        cursor: pointer;
        font-size: 14px;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        width: 100%;
      }
      .context-item:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        box-shadow: var(--neon-glow);
      }
      .skeleton {
        background: linear-gradient(
          90deg,
          var(--bg-secondary) 25%,
          var(--bg-tertiary) 50%,
          var(--bg-secondary) 75%
        );
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
        border-radius: var(--border-radius);
        height: 100%;
        width: 100%;
      }
      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }
      .loading {
        display: none;
        text-align: center;
        padding: 20px;
      }
      .loading.active {
        display: block;
      }
      .btn-group:not(.active) {
        display: none;
      }
      footer {
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(10px);
        border-top: 1px solid var(--border);
        padding: 10px 20px;
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: var(--footer-height);
        z-index: 100;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition);
      }
      footer.hidden {
        transform: translateY(100%);
      }
      .footer-content {
        display: flex;
        align-items: center;
        gap: 4px;
        text-align: center;
        color: var(--text-secondary);
        font-size: 12px;
        font-weight: 400;
        letter-spacing: 0.5px;
      }
      .footer-link {
        color: var(--accent);
        text-decoration: none;
        font-weight: 600;
        transition: var(--transition);
      }
      .footer-link:hover {
        color: var(--accent-hover);
        text-shadow: 0 0 8px rgba(0, 208, 132, 0.5);
      }
      /* Media Queries para Mobile */
      @media (max-width: 768px) {
        /* Esconder botões específicos da navbar em mobile */
        .desktop-only {
          display: none !important;
        }

        .header-custom {
          padding: 0 16px;
        }
        .logo {
          font-size: 24px;
        }
        .header-right {
          gap: 4px;
          justify-content: flex-end;
        }
        /* Ocultar botões que agora estão no hamburger */
        .header-right .btn-header {
          display: none;
        }
        .hamburger {
          display: flex;
        }
        main {
          overflow-y: auto;
          padding: 8px;
        }
        .grid-container {
          flex: none;
          height: auto;
          display: grid;
          grid-template-columns: 1fr !important;
          gap: 0;
          padding: 0;
        }
        #chat-selector {
          justify-content: center;
          flex-wrap: wrap;
        }
        .chat-btn {
          min-width: 80px;
        }
        .hero-title {
          font-size: 2.5rem;
        }
        .hero-subtitle {
          font-size: 1.2rem;
        }
        .toggle-btn {
          left: 16px; /* CORREÇÃO: Posição correta no mobile */
          bottom: -35px;
          padding: 10px 16px;
          font-size: 12px;
        }
        .toggle-btn.fixed {
          left: 16px; /* CORREÇÃO: Posição fixa correta no mobile */
          top: 8px; /* Ajuste sutil */
          padding: 6px;
          min-width: 180px;
        }
        .toggle-btn.fixed button {
          padding: 4px 8px;
          font-size: 11px;
        }
        footer {
          padding: 10px 16px;
          font-size: 11px;
        }
        .footer-content {
          gap: 2px;
          font-size: 11px;
        }
        .menu-toggle {
          left: 8px;
        }
        .context-menu {
          left: 8px;
        }
      }
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }
    </style>
  </head>
  <body>
    <header class="header-custom" id="main-header">
      <div class="logo silkscreen-regular">TELAZONA</div>
      <button
        id="toggle-header-footer"
        class="toggle-btn"
        aria-label="Ocultar/Mostrar Interface"
        data-i18n-text="hideUI"
      >
        <i class="ph ph-eye-slash" aria-hidden="true"></i> Ocultar Interface
      </button>
      <div class="header-right">
        <button
          id="add-live-btn"
          class="btn-header desktop-only"
          aria-label="Adicionar Nova Live"
        >
          <i class="ph ph-plus" aria-hidden="true"></i>
          <span data-i18n="addLiveBtn">Adicionar Live</span>
        </button>
        <button
          id="toggle-chat"
          class="btn-header desktop-only"
          aria-label="Mostrar/Ocultar Chat"
        >
          <i class="ph ph-chat-text" aria-hidden="true"></i>
          <span data-i18n="toggleChatBtnShow">Mostrar Chat</span>
        </button>
        <button
          id="help-btn"
          class="btn-header desktop-only"
          title="Reabrir tutorial"
        >
          <i class="ph ph-question"></i> <span data-i18n="helpBtn">Ajuda</span>
        </button>

        <button
          id="lang-toggle"
          class="btn-header desktop-only"
          aria-label="Alterar Idioma"
        >
          <i class="ph ph-globe" aria-hidden="true"></i>
          <span id="lang-abbr" data-i18n="langAbbr">PT</span>
        </button>

        <a
          href="https://picpay.me/seuusuario"
          target="_blank"
          rel="noopener"
          class="btn-header desktop-only"
          title="Doar pro TELAZONA"
          style="text-decoration: none"
        >
          <i class="ph ph-heart" style="color: #ff6b6b"></i>
          <span data-i18n="donateBtn">Doar</span>
        </a>
        <div
          class="hamburger"
          id="hamburger"
          role="button"
          aria-label="Abrir menu mobile"
          aria-expanded="false"
        >
          <span></span><span></span><span></span>
        </div>
      </div>
    </header>

    <div id="overlay" class="overlay"></div>

    <div id="mobile-menu" class="mobile-menu">
      <button id="close-menu" class="close-btn">
        <i class="ph ph-x"></i>
      </button>

      <button id="mobile-add-live-btn" class="mobile-btn">
        <i class="ph ph-plus"></i>
        <span data-i18n="addLiveBtn">Adicionar Live</span>
      </button>

      <button id="mobile-toggle-chat" class="mobile-btn">
        <i class="ph ph-chat-text"></i>
        <span data-i18n="toggleChatBtnShow">Mostrar/Ocultar Chat</span>
      </button>

      <button id="mobile-help-btn" class="mobile-btn">
        <i class="ph ph-question"></i>
        <span data-i18n="helpBtnFull">Ajuda / Tutorial</span>
      </button>

      <button id="mobile-lang-toggle" class="mobile-btn">
        <i class="ph ph-globe"></i>
        <span data-i18n="lang">Idioma: Português</span>
      </button>

      <a
        href="https://picpay.me/seuusuario"
        target="_blank"
        rel="noopener"
        class="mobile-btn"
        style="border: 2px solid var(--accent); color: var(--text-primary)"
      >
        <i class="ph ph-heart" style="color: #ff4444"></i>
        <span data-i18n="donateBtnFull">Doar pro TELAZONA</span>
      </a>
    </div>

    <div
      id="add-modal"
      class="add-modal"
      role="dialog"
      aria-labelledby="modal-title"
      aria-hidden="true"
    >
      <h2 id="modal-title" data-i18n="modalTitle">
        Adicionar Live (YouTube, Twitch ou Kick)
      </h2>
      <div class="platforms">
        <div class="platform-item">
          <i class="ph ph-youtube-logo" aria-hidden="true"></i>
          <div>YouTube</div>
        </div>
        <div class="platform-item">
          <i class="ph ph-twitch-logo" aria-hidden="true"></i>
          <div>Twitch</div>
        </div>
        <div class="platform-item">
          <i class="ph ph-fire" aria-hidden="true"></i>
          <div>Kick</div>
        </div>
      </div>
      <input
        type="url"
        id="live-url"
        data-i18n-placeholder="modalPlaceholder"
        placeholder="Cole a URL da live aqui... (ex: youtube.com/watch?v=ID, youtube.com/live/ID, twitch.tv/canal, kick.com/canal)"
        pattern="https?://.*"
        required
        aria-label="URL da Live"
      />
      <div id="loading-section" class="loading">
        <div class="loading-spinner"></div>
        <p data-i18n="validating">Validando live...</p>
      </div>
      <div class="btn-group active">
        <button
          id="cancel-add"
          class="btn-modal btn-secondary-modal"
          aria-label="Cancelar adição"
        >
          <i class="ph ph-x" aria-hidden="true"></i>
          <span data-i18n="modalCancel">Cancelar</span>
        </button>
        <button
          id="submit-add"
          class="btn-modal btn-primary-modal"
          aria-label="Adicionar Live"
        >
          <i class="ph ph-check" aria-hidden="true"></i>
          <span data-i18n="modalAdd">Adicionar</span>
        </button>
      </div>
    </div>

    <main id="main">
      <section id="hero-section" class="hero-section">
        <h1 class="hero-title silkscreen-regular" data-i18n="heroTitle">
          TELAZONA
        </h1>
        <p class="hero-subtitle" data-i18n="heroSubtitle">
          Assista múltiplas lives simultaneamente em uma única tela. Suporta
          YouTube, Twitch e Kick.
        </p>
        <button
          id="hero-add-btn"
          class="hero-btn"
          aria-label="Adicionar Primeira Live"
        >
          <i class="ph ph-play-circle" aria-hidden="true"></i>
          <span data-i18n="heroBtn">Adicionar Primeira Live</span>
        </button>
      </section>
      <div id="main-content">
        <section
          id="grid-section"
          class="grid-container"
          aria-label="Grade de Lives"
        ></section>
        <section
          id="chat-section"
          class="chat-container"
          aria-label="Seção de Chat"
        >
          <div id="chat-selector"></div>
          <div
            id="chat-placeholder"
            class="chat-placeholder"
            data-i18n="chatPlaceholder"
          >
            Selecione uma live para ver o chat.
          </div>
        </section>
      </div>
    </main>

    <footer id="main-footer">
      <div class="footer-content">
        <span data-i18n="footerText">Copyright © 2025 TELAZONA feito por</span>
        <a
          href="https://www.instagram.com/michelsantnasc/"
          class="footer-link"
          target="_blank"
          rel="noopener noreferrer"
          >Santnasc</a
        >
      </div>
    </footer>

    <div
      id="welcome-modal"
      class="add-modal"
      style="
        display: none;
        max-width: 520px;
        padding: 36px 28px;
        max-height: 95vh;
        overflow-y: auto;
      "
    >
      <button
        id="close-welcome"
        style="
          position: absolute;
          top: 12px;
          right: 12px;
          background: none;
          border: none;
          color: #aaa;
          font-size: 28px;
          cursor: pointer;
        "
      >
        <i class="ph ph-x"></i>
      </button>

      <h2
        style="
          font-size: 2.1rem;
          text-align: center;
          color: var(--accent);
          margin: 0 0 16px;
        "
        data-i18n="welcomeTitle"
      >
        Bem-vindo ao TELAZONA!
      </h2>
      <p
        style="
          text-align: center;
          color: #ccc;
          font-size: 1.05rem;
          margin-bottom: 32px;
        "
        data-i18n="welcomeSubtitle"
      >
        Assista várias lives ao mesmo tempo
      </p>

      <div style="display: grid; gap: 36px">
        <div style="display: flex; gap: 20px; align-items: flex-start">
          <div
            style="
              background: var(--gradient);
              color: white;
              width: 48px;
              height: 48px;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
              font-weight: bold;
              font-size: 1.2rem;
            "
          >
            1
          </div>
          <div style="width: 100%">
            <strong style="font-size: 1.15rem" data-i18n="step1Title"
              >Copie o link da live</strong
            >

            <div
              style="
                margin-top: 24px;
                display: flex;
                flex-direction: column;
                gap: 28px;
                align-items: center;
              "
            >
              <div style="text-align: center; width: 100%">
                <img
                  src="https://i.ibb.co/1t0nHJSD/msedge-Lw0-RNd9h-H0.png"
                  alt="YouTube"
                  style="
                    width: 100%;
                    max-width: 560px;
                    border-radius: 24px;
                    box-shadow: 0 20px 70px rgba(0, 0, 0, 0.95);
                    border: 6px solid var(--accent);
                  "
                />
                <div
                  style="
                    margin-top: 16px;
                    font-weight: 800;
                    font-size: 1.3rem;
                    color: var(--accent);
                    text-shadow: 0 0 20px rgba(0, 208, 132, 0.8);
                  "
                  data-i18n="ytShare"
                >
                  YouTube → Compartilhar
                </div>
              </div>

              <div style="text-align: center; width: 100%">
                <img
                  src="https://i.ibb.co/BHG6p2mR/msedge-Wdm4-XIkx-J7.png"
                  alt="Twitch"
                  style="
                    width: 100%;
                    max-width: 560px;
                    border-radius: 24px;
                    box-shadow: 0 20px 70px rgba(0, 0, 0, 0.95);
                    border: 6px solid var(--accent);
                  "
                />
                <div
                  style="
                    margin-top: 16px;
                    font-weight: 800;
                    font-size: 1.3rem;
                    color: var(--accent);
                    text-shadow: 0 0 20px rgba(0, 208, 132, 0.8);
                  "
                  data-i18n="twitchCopy"
                >
                  Twitch → Copie o link
                </div>
              </div>

              <div style="text-align: center; width: 100%">
                <img
                  src="https://i.ibb.co/xqFFfcnp/msedge-X5-Fm-Trj6-To.png"
                  alt="Kick"
                  style="
                    width: 100%;
                    max-width: 560px;
                    border-radius: 24px;
                    box-shadow: 0 20px 70px rgba(0, 0, 0, 0.95);
                    border: 6px solid var(--accent);
                  "
                />
                <div
                  style="
                    margin-top: 16px;
                    font-weight: 800;
                    font-size: 1.3rem;
                    color: var(--accent);
                    text-shadow: 0 0 20px rgba(0, 208, 132, 0.8);
                  "
                  data-i18n="kickCopy"
                >
                  Kick → Copie o link
                </div>
              </div>
            </div>
          </div>
        </div>

        <div style="display: flex; gap: 20px; align-items: flex-start">
          <div
            style="
              background: var(--gradient);
              color: white;
              width: 48px;
              height: 48px;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
              font-weight: bold;
              font-size: 1.2rem;
            "
          >
            2
          </div>
          <div>
            <strong style="font-size: 1.15rem" data-i18n="step2Title"
              >Cole aqui no TELAZONA</strong
            >
            <div style="margin: 24px auto 0; text-align: center">
              <img
                src="https://i.ibb.co/VGp2Wgd/msedge-wiwrl-YSKy2.png"
                alt="Colar link"
                style="
                  width: 100%;
                  max-width: 460px;
                  border-radius: 18px;
                  box-shadow: 0 12px 50px rgba(0, 0, 0, 0.8);
                  border: 3px solid var(--accent);
                "
              />
            </div>
          </div>
        </div>

        <div style="display: flex; gap: 20px; align-items: flex-start">
          <div
            style="
              background: var(--gradient);
              color: white;
              width: 48px;
              height: 48px;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
            "
          >
            <i class="ph ph-eye-slash" style="font-size: 24px"></i>
          </div>
          <div>
            <strong style="font-size: 1.15rem" data-i18n="step3Title"
              >Modo tela cheia</strong
            ><br />
            <small style="color: #aaa" data-i18n="step3Desc"
              >Botão no canto superior esquerdo para ocultar interface
              (cabeçalho e rodapé).</small
            >
          </div>
        </div>
      </div>

      <div
        style="
          margin-top: 40px;
          padding-top: 24px;
          border-top: 2px solid var(--accent);
          text-align: center;
        "
      >
        <label
          style="
            display: inline-flex;
            align-items: center;
            gap: 12px;
            color: #ddd;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
          "
        >
          <input
            type="checkbox"
            id="dont-show-welcome"
            style="width: 20px; height: 20px; accent-color: var(--accent)"
          />
          <span data-i18n="dontShowAgain">Não mostrar novamente</span>
        </label>

        <div style="margin-top: 24px">
          <button
            id="start-telazona"
            style="
              background: var(--gradient);
              color: white;
              border: none;
              padding: 16px 60px;
              border-radius: 14px;
              font-size: 1.3rem;
              cursor: pointer;
              box-shadow: 0 0 30px rgba(0, 208, 132, 0.7);
              font-weight: 600;
            "
          >
            <span data-i18n="letsGo">Vamos lá!</span>
          </button>
        </div>
      </div>
    </div>
    <script>
      const domain = window.location.hostname || "localhost";
      const header = document.getElementById("main-header");
      const footer = document.getElementById("main-footer");
      const main = document.getElementById("main");
      const hero = document.getElementById("hero-section");
      const mainContent = document.getElementById("main-content");
      const grid = document.getElementById("grid-section");
      const chatSection = document.getElementById("chat-section");
      const chatSelector = document.getElementById("chat-selector");
      const chatPlaceholder = document.getElementById("chat-placeholder");
      const toggleBtn = document.getElementById("toggle-header-footer");
      const toggleChatBtn = document.getElementById("toggle-chat");
      const mobileToggleChatBtn = document.getElementById("mobile-toggle-chat");
      const heroAddBtn = document.getElementById("hero-add-btn");
      const addLiveBtn = document.getElementById("add-live-btn");
      const mobileAddLiveBtn = document.getElementById("mobile-add-live-btn");
      const submitAddBtn = document.getElementById("submit-add");
      const cancelAddBtn = document.getElementById("cancel-add");
      const liveUrlInput = document.getElementById("live-url");
      const hamburger = document.getElementById("hamburger");
      const mobileMenu = document.getElementById("mobile-menu");
      const closeMenuBtn = document.getElementById("close-menu");
      const overlay = document.getElementById("overlay");
      const addModal = document.getElementById("add-modal");
      const loadingSection = document.getElementById("loading-section");
      const btnGroup = document.querySelector(".btn-group");

      const langToggleDesktop = document.getElementById("lang-toggle");
      const langToggleMobile = document.getElementById("mobile-lang-toggle");
      const langAbbrSpan = document.getElementById("lang-abbr");

      let lives = JSON.parse(sessionStorage.getItem("telazona-lives") || "[]");
      let deleteConfirmations = {};
      let currentSelected = -1;
      let chatVisible = false;
      let iframeObserver = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              const iframe = entry.target.querySelector(".live-frame");
              // Remove a checagem extra se a src já foi setada, para prevenir recarregamentos desnecessários
              if (iframe && iframe.dataset.src && !iframe.src) {
                iframe.src = iframe.dataset.src;
                delete iframe.dataset.src;

                // Remove o skeleton logo após o iframe começar a carregar
                const skeleton = entry.target.querySelector(".skeleton");
                if (skeleton) skeleton.style.display = "none";
              }
            }
          });
        },
        { threshold: 0.1 }
      );

      // NOVO: Dicionário de Textos (i18n)
      const i18n = {
        "pt-BR": {
          appTitle: "TELAZONA - Assista Múltiplas Lives Simultaneamente",
          appDescription:
            "Assista lives do YouTube, Twitch e Kick em uma única tela. Multistreaming simples e responsivo para mobile e desktop.",
          addLiveBtn: "Adicionar Live",
          toggleChatBtnShow: "Mostrar Chat",
          toggleChatBtnHide: "Ocultar Chat",
          helpBtn: "Ajuda",
          helpBtnFull: "Ajuda / Tutorial",
          donateBtn: "Doar",
          donateBtnFull: "Doar pro TELAZONA",
          hideUI: "Ocultar Interface",
          showUI: "Mostrar Interface",
          modalTitle: "Adicionar Live (YouTube, Twitch ou Kick)",
          modalPlaceholder:
            "Cole a URL da live aqui... (ex: youtube.com/watch?v=ID, twitch.tv/canal, kick.com/canal)",
          modalCancel: "Cancelar",
          modalAdd: "Adicionar",
          validating: "Validando live...",
          heroTitle: "TELAZONA",
          heroSubtitle:
            "Assista múltiplas lives simultaneamente em uma única tela. Suporta YouTube, Twitch e Kick.",
          heroBtn: "Adicionar Primeira Live",
          chatPlaceholder: "Selecione uma live para ver o chat.",
          chatHidden: 'Chat oculto. Clique em "Mostrar Chat" para ativar.',
          noKickChat:
            "Chat não disponível para Kick. Acesse o site oficial para interagir.",
          noChat: "Chat não disponível para esta live.",
          footerText: "Copyright © 2025 TELAZONA feito por",
          delete: "Deletar",
          confirmDelete: "Confirmar Deleção",
          invalidUrl:
            "URL inválida. Suporte apenas para YouTube, Twitch e Kick.",
          saveError: "Erro ao salvar. Tente novamente.",
          welcomeTitle: "Bem-vindo ao TELAZONA!",
          welcomeSubtitle: "Assista várias lives ao mesmo tempo",
          step1Title: "Copie o link da live",
          step2Title: "Cole aqui no TELAZONA",
          ytShare: "YouTube → Compartilhar",
          twitchCopy: "Twitch → Copie o link",
          kickCopy: "Kick → Copie o link",
          step3Title: "Modo tela cheia",
          step3Desc:
            "Botão no canto superior esquerdo para ocultar interface (cabeçalho e rodapé).",
          dontShowAgain: "Não mostrar novamente",
          letsGo: "Vamos lá!",
          lang: "Idioma: Português",
          langAbbr: "PT",
        },
        "en-US": {
          appTitle: "TELAZONA - Watch Multiple Streams Simultaneously",
          appDescription:
            "Watch YouTube, Twitch, and Kick streams on a single screen. Simple, responsive multistreaming for mobile and desktop.",
          addLiveBtn: "Add Stream",
          toggleChatBtnShow: "Show Chat",
          toggleChatBtnHide: "Hide Chat",
          helpBtn: "Help",
          helpBtnFull: "Help / Tutorial",
          donateBtn: "Donate",
          donateBtnFull: "Donate to TELAZONA",
          hideUI: "Hide Interface",
          showUI: "Show Interface",
          modalTitle: "Add Stream (YouTube, Twitch or Kick)",
          modalPlaceholder:
            "Paste the stream URL here... (ex: youtube.com/watch?v=ID, twitch.tv/channel, kick.com/channel)",
          modalCancel: "Cancel",
          modalAdd: "Add",
          validating: "Validating stream...",
          heroTitle: "TELAZONA",
          heroSubtitle:
            "Watch multiple streams simultaneously on a single screen. Supports YouTube, Twitch, and Kick.",
          heroBtn: "Add First Stream",
          chatPlaceholder: "Select a stream to view chat.",
          chatHidden: 'Chat hidden. Click "Show Chat" to activate.',
          noKickChat:
            "Chat not available for Kick. Use the official site to interact.",
          noChat: "Chat not available for this stream.",
          footerText: "Copyright © 2025 TELAZONA created by",
          delete: "Delete",
          confirmDelete: "Confirm Deletion",
          invalidUrl:
            "Invalid URL. Only YouTube, Twitch, and Kick are supported.",
          saveError: "Save error. Please try again.",
          welcomeTitle: "Welcome to TELAZONA!",
          welcomeSubtitle: "Watch multiple streams at the same time",
          step1Title: "Copy the stream link",
          step2Title: "Paste here on TELAZONA",
          ytShare: "YouTube → Share",
          twitchCopy: "Twitch → Copy link",
          kickCopy: "Kick → Copy link",
          step3Title: "Full-screen Mode",
          step3Desc:
            "Button in the top-left corner to hide interface (header and footer).",
          dontShowAgain: "Don't show again",
          letsGo: "Let's Go!",
          lang: "Language: English",
          langAbbr: "EN",
        },
      };

      let currentLang =
        localStorage.getItem("telazona-lang") ||
        (navigator.language.startsWith("pt") ? "pt-BR" : "en-US"); // Detecta idioma do navegador

      function getText(key) {
        return i18n[currentLang][key] || i18n["pt-BR"][key] || key;
      }

      function updateUI() {
        // 1. Atualizar atributos data-i18n
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          const key = el.getAttribute("data-i18n");
          el.textContent = getText(key);
        });

        // 2. Atualizar atributos data-i18n-text (para botões que tem ícone + texto)
        document.querySelectorAll("[data-i18n-text]").forEach((el) => {
          const key = el.getAttribute("data-i18n-text");
          const textNode = el.querySelector("i") ? el.lastChild : el;
          if (textNode) {
            const text = getText(key);
            if (textNode.nodeType === 3) {
              // Se for um nó de texto
              textNode.nodeValue = text;
            } else {
              textNode.textContent = text;
            }
          }
        });

        // 3. Atualizar placeholders
        document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
          const key = el.getAttribute("data-i18n-placeholder");
          el.setAttribute("placeholder", getText(key));
        });

        // 4. Elementos específicos
        document.title = getText("appTitle");
        document
          .querySelector('meta[name="description"]')
          .setAttribute("content", getText("appDescription"));
        document
          .querySelector('meta[property="og:description"]')
          .setAttribute("content", getText("appDescription"));

        // 5. Botões de interface (que mudam de texto)
        const chatIcon = '<i class="ph ph-chat-text" aria-hidden="true"></i>';
        const eyeIcon = header.classList.contains("hidden")
          ? '<i class="ph ph-eye" aria-hidden="true"></i>'
          : '<i class="ph ph-eye-slash" aria-hidden="true"></i>';

        toggleChatBtn.innerHTML = `${chatIcon} <span data-i18n="${
          chatVisible ? "toggleChatBtnHide" : "toggleChatBtnShow"
        }">${getText(
          chatVisible ? "toggleChatBtnHide" : "toggleChatBtnShow"
        )}</span>`;
        mobileToggleChatBtn.innerHTML = `${chatIcon} <span data-i18n="${
          chatVisible ? "toggleChatBtnHide" : "toggleChatBtnShow"
        }">${getText(
          chatVisible ? "toggleChatBtnHide" : "toggleChatBtnShow"
        )}</span>`;

        if (header.classList.contains("hidden")) {
          // Atualiza o botão fixo com texto de Mostrar Interface e Chat
          const chatIconFixed = chatVisible ? "x" : "chat-text";
          const chatTextFixed = chatVisible
            ? getText("toggleChatBtnHide")
            : getText("toggleChatBtnShow");

          toggleBtn.innerHTML = `
              <div class="controls-flex">
                <button class="show-ui-btn" onclick="showHeaderAndFooter(); event.stopPropagation();">
                  <i class="ph ph-eye" aria-hidden="true"></i> ${getText(
                    "showUI"
                  )}
                </button>
                <button class="chat-toggle-btn fixed-chat-toggle" onclick="handleFixedChatToggle(event);">
                  <i class="ph ph-${chatIconFixed}" aria-hidden="true"></i> ${chatTextFixed}
                </button>
              </div>
            `;
        } else {
          toggleBtn.innerHTML = `${eyeIcon} ${getText("hideUI")}`;
        }

        // 6. Seletor de Idioma
        langAbbrSpan.textContent = getText("langAbbr");
        langToggleMobile.querySelector("span").textContent = getText("lang");

        // 7. Placeholder de Chat
        if (!chatVisible) {
          chatPlaceholder.innerHTML = getText("chatHidden");
        } else {
          updateChat(); // Atualiza o chat, que usa getText
        }
      }

      function setLanguage(lang) {
        currentLang = lang;
        localStorage.setItem("telazona-lang", lang);
        updateUI();
      }

      function toggleLanguage() {
        const newLang = currentLang === "pt-BR" ? "en-US" : "pt-BR";
        setLanguage(newLang);
        closeMobileMenu();
      }

      langToggleDesktop.addEventListener("click", toggleLanguage);
      langToggleMobile.addEventListener("click", toggleLanguage);

      // FIM DO NOVO: Dicionário e i18n

      function populateChatSelect(visibleIndices) {
        chatSelector.innerHTML = "";
        visibleIndices.forEach((i) => {
          if (lives[i].platform === "kick") return;
          const btn = document.createElement("button");
          btn.className = `chat-btn ${i === currentSelected ? "active" : ""}`;
          btn.dataset.index = i.toString();
          btn.textContent = lives[i].channel || `${getText("live")} ${i + 1}`; // Usando getText
          btn.addEventListener("click", () => {
            document
              .querySelectorAll(".chat-btn")
              .forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            selectLive(i);
          });
          chatSelector.appendChild(btn);
        });
      }

      function updateChat() {
        if (currentSelected < 0 || !lives[currentSelected]) {
          chatPlaceholder.innerHTML = getText("chatPlaceholder");
          return;
        }
        if (lives[currentSelected].platform === "kick") {
          chatPlaceholder.innerHTML = getText("noKickChat");
          return;
        }
        const chatEmbed = lives[currentSelected].chatEmbed;
        if (!chatEmbed) {
          chatPlaceholder.innerHTML = getText("noChat");
          return;
        }
        chatPlaceholder.innerHTML = `<iframe src="${chatEmbed}" style="width:100%;height:100%;border:none;" allow="fullscreen" title="Chat da Live ${lives[currentSelected].channel}"></iframe>`;
      }

      function updateMainContentLayout(isMobile) {
        if (isMobile && chatVisible) {
          mainContent.style.flexDirection = "column";
          mainContent.style.overflowY = "auto";
          grid.style.flex = "none";
          grid.style.height = "auto";
          grid.style.width = "100%";
          chatSection.style.flex = "0 0 auto";
          chatSection.style.width = "100%";
          chatSection.style.borderLeft = "none";
          chatSection.style.borderTop = "1px solid var(--border)";
          chatSection.style.marginTop = "0";
          chatSection.style.height =
            "calc(100vh - var(--header-height) - var(--footer-height))";
          return;
        }
        if (isMobile) {
          mainContent.style.flexDirection = "column";
          mainContent.style.overflowY = "hidden";
          grid.style.flex = "none";
          grid.style.height = "auto";
          chatSection.style.flex = "1";
          chatSection.style.width = "100%";
          chatSection.style.borderLeft = "none";
          chatSection.style.borderTop = "1px solid var(--border)";
          chatSection.style.marginTop = "0";
        } else {
          mainContent.style.flexDirection = "row";
          mainContent.style.overflowY = "hidden";
          grid.style.flex = "1";
          grid.style.height = "100%";
          chatSection.style.flex = "0 0 350px";
          chatSection.style.width = "350px";
          chatSection.style.borderLeft = "1px solid var(--border)";
          chatSection.style.borderTop = "none";
          chatSection.style.marginTop = "0";
        }
      }

      function toggleChat() {
        chatVisible = !chatVisible;
        const icon = '<i class="ph ph-chat-text" aria-hidden="true"></i>';
        const isMobile = window.innerWidth <= 768;
        if (chatVisible) {
          chatSection.style.display = "flex";
          const visibleIndices = lives.map((_, idx) => idx);
          populateChatSelect(visibleIndices);
          chatSelector.style.display = "flex";
          updateChat();
          toggleChatBtn.innerHTML = `${icon} <span data-i18n="toggleChatBtnHide">${getText(
            "toggleChatBtnHide"
          )}</span>`;
          mobileToggleChatBtn.innerHTML = `${icon} <span data-i18n="toggleChatBtnHide">${getText(
            "toggleChatBtnHide"
          )}</span>`;
          updateMainContentLayout(isMobile);
        } else {
          chatPlaceholder.innerHTML = getText("chatHidden"); // Usando chatHidden aqui
          chatSection.style.display = "none";
          mainContent.style.flexDirection = "row";
          toggleChatBtn.innerHTML = `${icon} <span data-i18n="toggleChatBtnShow">${getText(
            "toggleChatBtnShow"
          )}</span>`;
          mobileToggleChatBtn.innerHTML = `${icon} <span data-i18n="toggleChatBtnShow">${getText(
            "toggleChatBtnShow"
          )}</span>`;
          updateMainContentLayout(isMobile);
        }
        updateLayoutPositions();
        if (header.classList.contains("hidden")) {
          // Atualiza o botão fixo se a UI estiver oculta
          hideHeaderAndFooter();
        }
      }

      function selectLive(index) {
        currentSelected = index;
        document
          .querySelectorAll(".live-wrapper")
          .forEach((w) => w.classList.remove("selected"));
        const selectedWrapper = document.querySelector(
          `[data-index="${index}"]`
        );
        if (selectedWrapper) selectedWrapper.classList.add("selected");
        if (chatVisible) {
          document
            .querySelectorAll(".chat-btn")
            .forEach((b) => b.classList.remove("active"));
          const activeBtn = document.querySelector(
            `.chat-btn[data-index="${index}"]`
          );
          if (activeBtn) activeBtn.classList.add("active");
          updateChat();
        }
      }

      // CORREÇÃO: Lógica simplificada para reposicionar o botão de volta ao header,
      // confiando no CSS para 'left' e 'bottom' (inclusive no mobile).
      function showHeaderAndFooter() {
        header.classList.remove("hidden");
        footer.classList.remove("hidden");

        // CORREÇÃO: Sempre move o botão de volta para dentro do header,
        // antes do header-right.
        const headerRight = document.querySelector(".header-right");
        header.insertBefore(toggleBtn, headerRight);

        updateLayoutPositions();
        toggleBtn.innerHTML = `<i class="ph ph-eye-slash" aria-hidden="true"></i> ${getText(
          "hideUI"
        )}`;

        // Remove .fixed e todos os estilos inline para que o CSS assuma
        toggleBtn.classList.remove("fixed");
        toggleBtn.style.position = "";
        toggleBtn.style.top = "";
        toggleBtn.style.bottom = "";
        toggleBtn.style.left = "";
        toggleBtn.style.minWidth = "";

        renderLives();
      }

      function hideHeaderAndFooter() {
        header.classList.add("hidden");
        footer.classList.add("hidden");
        document.body.appendChild(toggleBtn);
        updateLayoutPositions();

        const chatIconClass = chatVisible ? "x" : "chat-text";
        const chatText = chatVisible
          ? getText("toggleChatBtnHide")
          : getText("toggleChatBtnShow");

        toggleBtn.innerHTML = `
          <div class="controls-flex">
            <button class="show-ui-btn" onclick="showHeaderAndFooter(); event.stopPropagation();">
              <i class="ph ph-eye" aria-hidden="true"></i> ${getText("showUI")}
            </button>
            <button class="chat-toggle-btn fixed-chat-toggle" onclick="handleFixedChatToggle(event);">
              <i class="ph ph-${chatIconClass}" aria-hidden="true"></i> ${chatText}
            </button>
          </div>
        `;
        // CORREÇÃO: Remove style.left="24px" para que o CSS mobile (left: 16px) funcione
        toggleBtn.classList.add("fixed");
        toggleBtn.style.position = "fixed";
        toggleBtn.style.top = "10px";
        toggleBtn.style.bottom = "auto";
        toggleBtn.style.left = ""; // Remove inline override
        renderLives();
      }

      function handleFixedChatToggle(e) {
        e.stopPropagation();
        const fixedChatToggle =
          e.target.closest(".fixed-chat-toggle") || e.target;
        toggleChat();
        const chatIconClass = chatVisible ? "x" : "chat-text";
        const chatText = chatVisible
          ? getText("toggleChatBtnHide")
          : getText("toggleChatBtnShow");
        fixedChatToggle.innerHTML = `<i class="ph ph-${chatIconClass}" aria-hidden="true"></i> ${chatText}`;
      }

      function toggleHeaderFooter() {
        if (header.classList.contains("hidden")) {
          showHeaderAndFooter();
        } else {
          hideHeaderAndFooter();
        }
      }

      function updateLayoutPositions() {
        const headerVisible = !header.classList.contains("hidden");
        const footerVisible = !footer.classList.contains("hidden");
        const headerH = headerVisible ? 60 : 0;
        const footerH = footerVisible ? 30 : 0;
        main.style.marginTop = `${headerH}px`;
        main.style.height = `calc(100vh - ${headerH + footerH}px)`;
      }

      function appendParams(base, isMini) {
        let params;
        if (base.includes("youtube.com/embed")) {
          params = isMini
            ? "autoplay=0&mute=1"
            : "autoplay=1&mute=0&enablejsapi=1";
        } else if (
          base.includes("player.twitch.tv") ||
          base.includes("player.kick.com")
        ) {
          params = isMini
            ? "autoplay=false&muted=true"
            : "autoplay=true&muted=false";
        } else {
          return base;
        }
        const separator = base.includes("?") ? "&" : "?";
        return base + separator + params;
      }

      function extractYouTubeId(url) {
        const regExp =
          /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=|live\/)([^#&?]*).*/;
        const match = url.match(regExp);
        return match && match[2].length === 11 ? match[2] : null;
      }

      function extractTwitchChannel(url) {
        let match = url.match(/twitch\.tv\/([a-zA-Z0-9_]+)/i);
        if (!match) {
          match = url.match(/channel=([a-zA-Z0-9_]+)/i);
        }
        return match ? match[1] : null;
      }

      function extractKickChannel(url) {
        let match = url.match(/kick\.com\/([a-zA-Z0-9_]+)/i);
        if (!match) {
          match = url.match(/player\.kick\.com\/([a-zA-Z0-9_]+)/i);
        }
        return match ? match[1] : null;
      }

      function extractChannelName(url, platform) {
        if (platform === "youtube") return "YouTube Live";
        if (platform === "twitch") {
          const channel = extractTwitchChannel(url);
          return channel ? `@${channel}` : "Twitch Live";
        }
        if (platform === "kick") {
          const channel = extractKickChannel(url);
          return channel ? `@${channel}` : "Kick Live";
        }
        return "Live";
      }

      function generateLiveEmbed(url) {
        const videoId = extractYouTubeId(url);
        if (videoId) return `https://www.youtube.com/embed/${videoId}`;
        const twitchChannel = extractTwitchChannel(url);
        if (twitchChannel) {
          return `https://player.twitch.tv/?channel=${twitchChannel}&parent=${domain}`;
        }
        const kickChannel = extractKickChannel(url);
        if (kickChannel)
          return `https://player.kick.com/${kickChannel}?parent=${domain}`;
        if (
          url.includes("youtube.com/embed") ||
          url.includes("player.twitch.tv") ||
          url.includes("player.kick.com")
        ) {
          return url;
        }
        return null;
      }

      function generateChatEmbed(url) {
        const videoId = extractYouTubeId(url);
        if (videoId)
          return `https://www.youtube.com/live_chat?v=${videoId}&embed_domain=${domain}`;
        const twitchChannel = extractTwitchChannel(url);
        if (twitchChannel)
          return `https://www.twitch.tv/embed/${twitchChannel}/chat?darkpopout&parent=${domain}`;
        const kickChannel = extractKickChannel(url);
        if (kickChannel) return null;
        return null;
      }

      function toggleMobileMenu() {
        const isActive = hamburger.classList.contains("active");
        hamburger.classList.toggle("active");
        hamburger.setAttribute("aria-expanded", !isActive);
        mobileMenu.classList.toggle("active");
        overlay.classList.toggle("active");
        document.body.style.overflow = isActive ? "" : "hidden";
      }

      function closeMobileMenu() {
        hamburger.classList.remove("active");
        hamburger.setAttribute("aria-expanded", "false");
        mobileMenu.classList.remove("active");

        if (
          !addModal.classList.contains("active") &&
          welcomeModal.style.display !== "flex"
        ) {
          overlay.classList.remove("active");
          document.body.style.overflow = "";
        }
      }

      function handleOverlayClick() {
        if (mobileMenu.classList.contains("active")) {
          closeMobileMenu();
        } else if (addModal.classList.contains("active")) {
          closeAddModal();
        } else if (welcomeModal.style.display === "flex") {
          hideWelcome();
        }
      }

      overlay.addEventListener("click", handleOverlayClick);

      function updateLayout(visibleLives, isUIHidden) {
        if (window.innerWidth <= 768) {
          grid.style.gridTemplateColumns = "1fr";
          grid.style.gridAutoRows = "auto";
          return;
        }
        let cols;
        if (visibleLives === 1) {
          cols = 1;
        } else if (visibleLives <= 4) {
          cols = 2;
        } else {
          cols = 3;
        }
        if (visibleLives === 1) {
          grid.style.gridTemplateColumns = "1fr";
          grid.style.gridTemplateRows = "1fr";
          grid.style.gap = "0";
          grid.style.justifyContent = "center";
          grid.style.alignContent = "center";
          return;
        }
        grid.style.gap = "0";
        grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
        if (cols === 2 && isUIHidden) {
          const rows = Math.ceil(visibleLives / cols);
          grid.style.gridTemplateRows = `repeat(${rows}, 1fr)`;
          grid.style.alignContent = "stretch";
        } else {
          grid.style.gridAutoRows = "auto";
          grid.style.alignContent = "start";
        }
      }

      function performDelete(i, contextMenu = null) {
        try {
          const wasSelected = currentSelected === i;
          lives.splice(i, 1);
          delete deleteConfirmations[i];
          if (wasSelected) {
            currentSelected = lives.length > 0 ? lives.length - 1 : -1;
          } else if (currentSelected > i) {
            currentSelected--;
          }
          const oldConf = { ...deleteConfirmations };
          deleteConfirmations = {};
          lives.forEach((_, newIdx) => {
            deleteConfirmations[newIdx] = oldConf[newIdx] || 0;
          });
          sessionStorage.setItem("telazona-lives", JSON.stringify(lives));
          updateLayoutPositions();
          if (lives.length === 0) {
            location.reload();
            return;
          }
          renderLives();
          if (contextMenu) contextMenu.classList.remove("active");
          if (chatVisible) {
            const visibleIndices = lives.map((_, idx) => idx);
            populateChatSelect(visibleIndices);
            updateChat();
          }
        } catch (e) {
          console.error("Erro ao deletar:", e);
        }
      }

      function closeContextMenus(e) {
        if (
          !e.target.closest(".menu-toggle") &&
          !e.target.closest(".context-menu") &&
          !e.target.closest(".context-item")
        ) {
          document
            .querySelectorAll(".context-menu.active")
            .forEach((m) => m.classList.remove("active"));
        }
      }

      function renderLives() {
        const visibleLives = lives.length;
        const isUIHidden =
          header.classList.contains("hidden") &&
          footer.classList.contains("hidden");
        if (visibleLives === 0) {
          hero.style.display = "flex";
          mainContent.style.display = "none";
          currentSelected = -1;
          if (chatVisible) {
            toggleChat();
          }
          return;
        }
        hero.style.display = "none";
        mainContent.style.display = "flex";
        grid.style.display = "grid";
        updateLayout(visibleLives, isUIHidden);
        let cols;
        if (visibleLives === 1) {
          cols = 1;
        } else if (visibleLives <= 4) {
          cols = 2;
        } else {
          cols = 3;
        }
        const existingWrappers = grid.querySelectorAll(".live-wrapper");
        if (existingWrappers.length === visibleLives) {
          return;
        }
        grid.innerHTML = "";
        lives.forEach((live, i) => {
          const wrapper = document.createElement("div");
          wrapper.dataset.index = i;
          let className = "live-wrapper";
          if (i === currentSelected) className += " selected";
          if (visibleLives === 1) className += " full-height";
          if (cols === 2 && !isUIHidden) className += " two-col";
          if (cols === 2 && isUIHidden) className += " stretch-height";
          wrapper.className = className;
          const skeleton = document.createElement("div");
          skeleton.className = "skeleton";
          wrapper.appendChild(skeleton);
          const iframe = document.createElement("iframe");
          iframe.className = "live-frame";
          iframe.dataset.src = appendParams(live.embed, false);
          // 💡 Adicionado o 'allow' completo para fullscreeen e mídia.
          iframe.allow =
            "autoplay; encrypted-media; fullscreen; picture-in-picture; gyroscope";
          iframe.loading = "lazy";
          iframe.title = `Live: ${live.channel}`;
          // 💡 Sandbox completo incluindo 'allow-presentation' para Chromecast/Cast.
          iframe.sandbox =
            "allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-presentation";
          wrapper.appendChild(iframe);
          wrapper.addEventListener("click", (e) => {
            if (
              e.target.closest(".menu-toggle") ||
              e.target.closest(".context-menu")
            )
              return;
            selectLive(i);
          });
          const menuToggle = document.createElement("button");
          menuToggle.className = "menu-toggle";
          menuToggle.innerHTML =
            '<i class="ph ph-dots-three" aria-hidden="true"></i>';
          menuToggle.setAttribute("aria-label", "Opções da Live");
          const contextMenu = document.createElement("div");
          contextMenu.className = "context-menu";
          const deleteItem = document.createElement("button");
          deleteItem.className = "context-item";
          deleteItem.innerHTML = `<i class="ph ph-trash" aria-hidden="true"></i> <span data-i18n="delete">${getText(
            "delete"
          )}</span>`;
          deleteItem.setAttribute("aria-label", "Deletar Live");
          let confTimer;
          deleteItem.addEventListener("click", (e) => {
            e.stopPropagation();
            const conf = deleteConfirmations[i] || 0;
            if (conf === 0) {
              deleteConfirmations[i] = 1;
              deleteItem.innerHTML = `<i class="ph ph-trash" aria-hidden="true"></i> <span data-i18n="confirmDelete">${getText(
                "confirmDelete"
              )}</span>`;
              confTimer = setTimeout(() => {
                deleteConfirmations[i] = 0;
                deleteItem.innerHTML = `<i class="ph ph-trash" aria-hidden="true"></i> <span data-i18n="delete">${getText(
                  "delete"
                )}</span>`;
              }, 3000);
            } else {
              clearTimeout(confTimer);
              performDelete(i, contextMenu);
            }
          });
          contextMenu.appendChild(deleteItem);
          menuToggle.addEventListener("click", (e) => {
            e.stopPropagation();
            const wasActive = contextMenu.classList.contains("active");
            document
              .querySelectorAll(".context-menu.active")
              .forEach((m) => m.classList.remove("active"));
            if (!wasActive) {
              contextMenu.classList.add("active");
            }
          });
          wrapper.appendChild(menuToggle);
          wrapper.appendChild(contextMenu);
          grid.appendChild(wrapper);
          iframeObserver.observe(wrapper);
        });
        if (chatVisible) {
          const isMobile = window.innerWidth <= 768;
          const visibleIndices = lives.map((_, idx) => idx);
          populateChatSelect(visibleIndices);
          updateChat();
          updateMainContentLayout(isMobile);
        }
        document.removeEventListener("click", closeContextMenus, true);
        document.addEventListener("click", closeContextMenus, true);
      }

      function showAddModal() {
        addModal.classList.add("active");
        addModal.setAttribute("aria-hidden", "false");
        overlay.classList.add("active");
        liveUrlInput.focus();
        closeMobileMenu();
      }

      function closeAddModal() {
        addModal.classList.remove("active");
        addModal.setAttribute("aria-hidden", "true");

        if (
          !mobileMenu.classList.contains("active") &&
          welcomeModal.style.display !== "flex"
        ) {
          overlay.classList.remove("active");
          document.body.style.overflow = "";
        }
        liveUrlInput.value = "";
      }

      async function addLive() {
        const url = liveUrlInput.value.trim();
        if (!url) return;
        const loading = loadingSection;
        const btnGroup = document.querySelector(".btn-group");
        loading.classList.add("active");
        btnGroup.classList.remove("active");
        const embedUrl = generateLiveEmbed(url);
        if (!embedUrl) {
          loading.classList.remove("active");
          btnGroup.classList.add("active");
          return alert(getText("invalidUrl"));
        }
        try {
          const chatEmbedUrl = generateChatEmbed(url);
          const videoId = extractYouTubeId(url);
          const twitchChannel = extractTwitchChannel(url);
          const kickChannel = extractKickChannel(url);
          let platform = null;
          if (videoId) platform = "youtube";
          else if (twitchChannel) platform = "twitch";
          else if (kickChannel) platform = "kick";
          const channelName = extractChannelName(url, platform);
          const newIndex = lives.length;
          lives.push({
            embed: embedUrl,
            chatEmbed: chatEmbedUrl,
            platform: platform,
            channel: channelName,
          });
          deleteConfirmations[newIndex] = 0;
          currentSelected = newIndex;
          sessionStorage.setItem("telazona-lives", JSON.stringify(lives));
          closeAddModal();
          renderLives();
          if (lives.length === 1 && !chatVisible) {
            toggleChat();
          } else if (chatVisible) {
            const isMobile = window.innerWidth <= 768;
            const visibleIndices = lives.map((_, idx) => idx);
            populateChatSelect(visibleIndices);
            updateChat();
            updateMainContentLayout(isMobile);
          }
        } catch (e) {
          console.error("Erro ao adicionar:", e);
          alert(getText("saveError"));
        } finally {
          loading.classList.remove("active");
          btnGroup.classList.add("active");
        }
      }

      addLiveBtn.addEventListener("click", showAddModal);
      heroAddBtn.addEventListener("click", showAddModal);
      submitAddBtn.addEventListener("click", addLive);
      cancelAddBtn.addEventListener("click", closeAddModal);
      liveUrlInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") addLive();
      });
      hamburger.addEventListener("click", toggleMobileMenu);
      closeMenuBtn.addEventListener("click", closeMobileMenu);

      toggleBtn.addEventListener("click", (e) => {
        if (toggleBtn.classList.contains("fixed")) {
          return;
        }
        toggleHeaderFooter();
      });
      toggleChatBtn.addEventListener("click", toggleChat);

      mobileAddLiveBtn.addEventListener("click", () => {
        closeMobileMenu();
        showAddModal();
      });

      mobileToggleChatBtn.addEventListener("click", () => {
        toggleChat();
        closeMobileMenu();
      });

      window.addEventListener(
        "resize",
        debounce(() => {
          renderLives();
          updateLayoutPositions();
          if (chatVisible) {
            const isMobile = window.innerWidth <= 768;
            updateMainContentLayout(isMobile);
            const visibleIndices = lives.map((_, idx) => idx);
            populateChatSelect(visibleIndices);
          }

          if (!header.classList.contains("hidden")) {
            showHeaderAndFooter();
          }
          updateUI(); // NOVO: Atualiza textos ao redimensionar
        }, 100)
      );

      updateUI(); // Chamada inicial para definir o idioma
      updateLayoutPositions();
      renderLives();
      showHeaderAndFooter();

      const welcomeModal = document.getElementById("welcome-modal");
      const closeWelcome = document.getElementById("close-welcome");
      const startBtn = document.getElementById("start-telazona");
      const dontShow = document.getElementById("dont-show-welcome");

      function showWelcome() {
        welcomeModal.style.display = "flex";
        overlay.classList.add("active");
        document.body.style.overflow = "hidden";
        welcomeModal.scrollTop = 0;
        updateUI(); // Atualiza textos do modal de boas-vindas
      }

      function hideWelcome() {
        welcomeModal.style.display = "none";

        if (
          !addModal.classList.contains("active") &&
          !mobileMenu.classList.contains("active")
        ) {
          overlay.classList.remove("active");
          document.body.style.overflow = "";
        }
      }

      if (!localStorage.getItem("telazona-welcome-seen")) {
        setTimeout(showWelcome, 1000);
      }

      closeWelcome.onclick = startBtn.onclick = () => {
        if (dontShow.checked)
          localStorage.setItem("telazona-welcome-seen", "true");
        hideWelcome();
      };

      document.getElementById("help-btn")?.addEventListener("click", () => {
        localStorage.removeItem("telazona-welcome-seen");
        showWelcome();
      });

      document
        .getElementById("mobile-help-btn")
        ?.addEventListener("click", () => {
          closeMobileMenu();
          localStorage.removeItem("telazona-welcome-seen");
          showWelcome();
        });

      document.querySelectorAll('a[href*="picpay.me"]').forEach((link) => {
        link.addEventListener("click", () => {
          closeMobileMenu();
        });
      });

      if (window.innerWidth > 768) {
        document.querySelectorAll("#welcome-modal img").forEach((img) => {
          img.style.cursor = "zoom-in";
          img.addEventListener(
            "mouseenter",
            () => (img.style.transform = "scale(1.08)")
          );
          img.addEventListener(
            "mouseleave",
            () => (img.style.transform = "scale(1)")
          );
          img.style.transition = "transform 0.5s ease";
        });
      }
    </script>
  </body>
</html>
